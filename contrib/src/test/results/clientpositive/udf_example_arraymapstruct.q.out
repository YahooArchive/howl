query: CREATE TEMPORARY FUNCTION example_arraysum    AS 'org.apache.hadoop.hive.contrib.udf.example.UDFExampleArraySum'
query: CREATE TEMPORARY FUNCTION example_mapconcat   AS 'org.apache.hadoop.hive.contrib.udf.example.UDFExampleMapConcat'
query: CREATE TEMPORARY FUNCTION example_structprint AS 'org.apache.hadoop.hive.contrib.udf.example.UDFExampleStructPrint'
query: EXPLAIN
SELECT example_arraysum(lint), example_mapconcat(mstringstring), example_structprint(lintstring[0])
FROM src_thrift
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF src_thrift)) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR (TOK_FUNCTION example_arraysum (TOK_TABLE_OR_COL lint))) (TOK_SELEXPR (TOK_FUNCTION example_mapconcat (TOK_TABLE_OR_COL mstringstring))) (TOK_SELEXPR (TOK_FUNCTION example_structprint ([ (TOK_TABLE_OR_COL lintstring) 0))))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        src_thrift 
          TableScan
            alias: src_thrift
            Select Operator
              expressions:
                    expr: example_arraysum(lint)
                    type: double
                    expr: example_mapconcat(mstringstring)
                    type: string
                    expr: example_structprint(lintstring[0])
                    type: string
              outputColumnNames: _col0, _col1, _col2
              File Output Operator
                compressed: false
                GlobalTableId: 0
                table:
                    input format: org.apache.hadoop.mapred.TextInputFormat
                    output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


query: SELECT example_arraysum(lint), example_mapconcat(mstringstring), example_structprint(lintstring[0])
FROM src_thrift
Input: default/src_thrift
Output: file:/data/users/zshao/tools/699-trunk-apache-hive/build/ql/tmp/1971586889/10000
0.0	(key_0:value_0)	(0:0)(1:0)(2:0)
6.0	(key_1:value_1)	(0:1)(1:1)(2:1)
12.0	(key_2:value_2)	(0:4)(1:8)(2:2)
18.0	(key_3:value_3)	(0:9)(1:27)(2:3)
24.0	(key_4:value_4)	(0:16)(1:64)(2:4)
30.0	(key_5:value_5)	(0:25)(1:125)(2:5)
36.0	(key_6:value_6)	(0:36)(1:216)(2:6)
42.0	(key_7:value_7)	(0:49)(1:343)(2:7)
48.0	(key_8:value_8)	(0:64)(1:512)(2:8)
54.0	(key_9:value_9)	(0:81)(1:729)(2:9)
NULL	NULL	NULL
query: DROP TEMPORARY FUNCTION example_arraysum
query: DROP TEMPORARY FUNCTION example_mapconcat
query: DROP TEMPORARY FUNCTION example_structprint
