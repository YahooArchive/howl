PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
PREHOOK: query: -- CREATE with comment
CREATE DATABASE test_db COMMENT 'Hive test database'
PREHOOK: type: CREATEDATABASE
POSTHOOK: query: -- CREATE with comment
CREATE DATABASE test_db COMMENT 'Hive test database'
POSTHOOK: type: CREATEDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- CREATE INE already exists
CREATE DATABASE IF NOT EXISTS test_db
PREHOOK: type: CREATEDATABASE
POSTHOOK: query: -- CREATE INE already exists
CREATE DATABASE IF NOT EXISTS test_db
POSTHOOK: type: CREATEDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- SHOW DATABASES synonym
SHOW SCHEMAS
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: -- SHOW DATABASES synonym
SHOW SCHEMAS
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- DROP
DROP DATABASE test_db
PREHOOK: type: DROPDATABASE
POSTHOOK: query: -- DROP
DROP DATABASE test_db
POSTHOOK: type: DROPDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
PREHOOK: query: -- CREATE INE doesn't exist
CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
PREHOOK: type: CREATEDATABASE
POSTHOOK: query: -- CREATE INE doesn't exist
CREATE DATABASE IF NOT EXISTS test_db COMMENT 'Hive test database'
POSTHOOK: type: CREATEDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- DROP IE exists
DROP DATABASE IF EXISTS test_db
PREHOOK: type: DROPDATABASE
POSTHOOK: query: -- DROP IE exists
DROP DATABASE IF EXISTS test_db
POSTHOOK: type: DROPDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
PREHOOK: query: -- DROP IE doesn't exist
DROP DATABASE IF EXISTS test_db
PREHOOK: type: DROPDATABASE
POSTHOOK: query: -- DROP IE doesn't exist
DROP DATABASE IF EXISTS test_db
POSTHOOK: type: DROPDATABASE
PREHOOK: query: -- SHOW
CREATE DATABASE test_db
PREHOOK: type: CREATEDATABASE
POSTHOOK: query: -- SHOW
CREATE DATABASE test_db
POSTHOOK: type: CREATEDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- SHOW pattern
SHOW DATABASES LIKE 'test*'
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: -- SHOW pattern
SHOW DATABASES LIKE 'test*'
POSTHOOK: type: SHOWDATABASES
test_db
PREHOOK: query: -- SHOW pattern
SHOW DATABASES LIKE '*ef*'
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: -- SHOW pattern
SHOW DATABASES LIKE '*ef*'
POSTHOOK: type: SHOWDATABASES
default
PREHOOK: query: USE test_db
PREHOOK: type: SWITCHDATABASE
POSTHOOK: query: USE test_db
POSTHOOK: type: SWITCHDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
test_db
PREHOOK: query: -- CREATE table in non-default DB
CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- CREATE table in non-default DB
CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: test_db@test_table
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
test_table
PREHOOK: query: -- DESCRIBE table in non-default DB
DESCRIBE test_table
PREHOOK: type: DESCTABLE
POSTHOOK: query: -- DESCRIBE table in non-default DB
DESCRIBE test_table
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
col1                	string              	None                
PREHOOK: query: -- DESCRIBE EXTENDED in non-default DB
DESCRIBE EXTENDED test_table
PREHOOK: type: DESCTABLE
POSTHOOK: query: -- DESCRIBE EXTENDED in non-default DB
DESCRIBE EXTENDED test_table
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
col1                	string              	None                
	 	 
# Detailed Table Information	 	 
Database:           	test_db             	 
Owner:              	thiruvel            	 
CreateTime:         	Tue Sep 14 08:14:02 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Retention:          	0                   	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/test_db.db/test_table	 
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	transient_lastDdlTime	1284477242          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
PREHOOK: query: -- CREATE LIKE in non-default DB
CREATE TABLE test_table_like LIKE test_table
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- CREATE LIKE in non-default DB
CREATE TABLE test_table_like LIKE test_table
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: test_db@test_table_like
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
test_table
test_table_like
PREHOOK: query: DESCRIBE EXTENDED test_table_like
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE EXTENDED test_table_like
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
col1                	string              	None                
	 	 
# Detailed Table Information	 	 
Database:           	test_db             	 
Owner:              	thiruvel            	 
CreateTime:         	Tue Sep 14 08:14:02 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Retention:          	0                   	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/test_db.db/test_table_like	 
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	EXTERNAL            	FALSE               
	transient_lastDdlTime	1284477242          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
PREHOOK: query: -- LOAD and SELECT
LOAD DATA LOCAL INPATH '../data/files/test.dat' OVERWRITE INTO TABLE test_table
PREHOOK: type: LOAD
POSTHOOK: query: -- LOAD and SELECT
LOAD DATA LOCAL INPATH '../data/files/test.dat' OVERWRITE INTO TABLE test_table
POSTHOOK: type: LOAD
POSTHOOK: Output: test_db@test_table
PREHOOK: query: SELECT * FROM test_table
PREHOOK: type: QUERY
PREHOOK: Input: test_db@test_table
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_014_3734417394191268060/-mr-10000
POSTHOOK: query: SELECT * FROM test_table
POSTHOOK: type: QUERY
POSTHOOK: Input: test_db@test_table
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_014_3734417394191268060/-mr-10000
1
2
3
4
5
6
PREHOOK: query: -- DROP and CREATE w/o LOAD
DROP TABLE test_table
PREHOOK: type: DROPTABLE
PREHOOK: Input: test_db@test_table
PREHOOK: Output: test_db@test_table
POSTHOOK: query: -- DROP and CREATE w/o LOAD
DROP TABLE test_table
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: test_db@test_table
POSTHOOK: Output: test_db@test_table
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
test_table_like
PREHOOK: query: CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE test_table (col1 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: test_db@test_table
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
test_table
test_table_like
PREHOOK: query: SELECT * FROM test_table
PREHOOK: type: QUERY
PREHOOK: Input: test_db@test_table
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_657_3100419213937707581/-mr-10000
POSTHOOK: query: SELECT * FROM test_table
POSTHOOK: type: QUERY
POSTHOOK: Input: test_db@test_table
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_657_3100419213937707581/-mr-10000
PREHOOK: query: -- CREATE table that already exists in DEFAULT
USE test_db
PREHOOK: type: SWITCHDATABASE
POSTHOOK: query: -- CREATE table that already exists in DEFAULT
USE test_db
POSTHOOK: type: SWITCHDATABASE
PREHOOK: query: CREATE TABLE src (col1 STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE src (col1 STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: test_db@src
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
src
test_table
test_table_like
PREHOOK: query: SELECT * FROM src LIMIT 10
PREHOOK: type: QUERY
PREHOOK: Input: test_db@src
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_810_3196244583692570364/-mr-10000
POSTHOOK: query: SELECT * FROM src LIMIT 10
POSTHOOK: type: QUERY
POSTHOOK: Input: test_db@src
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_810_3196244583692570364/-mr-10000
PREHOOK: query: USE default
PREHOOK: type: SWITCHDATABASE
POSTHOOK: query: USE default
POSTHOOK: type: SWITCHDATABASE
PREHOOK: query: SELECT * FROM src LIMIT 10
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_870_6860222356519835640/-mr-10000
POSTHOOK: query: SELECT * FROM src LIMIT 10
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-14-03_870_6860222356519835640/-mr-10000
238	val_238
86	val_86
311	val_311
27	val_27
165	val_165
409	val_409
255	val_255
278	val_278
98	val_98
484	val_484
PREHOOK: query: -- DROP DATABASE
USE test_db
PREHOOK: type: SWITCHDATABASE
POSTHOOK: query: -- DROP DATABASE
USE test_db
POSTHOOK: type: SWITCHDATABASE
PREHOOK: query: DROP TABLE src
PREHOOK: type: DROPTABLE
PREHOOK: Input: test_db@src
PREHOOK: Output: test_db@src
POSTHOOK: query: DROP TABLE src
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: test_db@src
POSTHOOK: Output: test_db@src
PREHOOK: query: DROP TABLE test_table
PREHOOK: type: DROPTABLE
PREHOOK: Input: test_db@test_table
PREHOOK: Output: test_db@test_table
POSTHOOK: query: DROP TABLE test_table
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: test_db@test_table
POSTHOOK: Output: test_db@test_table
PREHOOK: query: DROP TABLE test_table_like
PREHOOK: type: DROPTABLE
PREHOOK: Input: test_db@test_table_like
PREHOOK: Output: test_db@test_table_like
POSTHOOK: query: DROP TABLE test_table_like
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: test_db@test_table_like
POSTHOOK: Output: test_db@test_table_like
PREHOOK: query: SHOW TABLES
PREHOOK: type: SHOWTABLES
POSTHOOK: query: SHOW TABLES
POSTHOOK: type: SHOWTABLES
PREHOOK: query: USE default
PREHOOK: type: SWITCHDATABASE
POSTHOOK: query: USE default
POSTHOOK: type: SWITCHDATABASE
PREHOOK: query: DROP DATABASE test_db
PREHOOK: type: DROPDATABASE
POSTHOOK: query: DROP DATABASE test_db
POSTHOOK: type: DROPDATABASE
PREHOOK: query: SHOW DATABASES
PREHOOK: type: SHOWDATABASES
POSTHOOK: query: SHOW DATABASES
POSTHOOK: type: SHOWDATABASES
default
