PREHOOK: query: -- Tests the case where a table is changed from sequence file to a RC file,
-- resulting in partitions in both file formats. If no valid partitions are
-- selected, then it should still use RC file for reading the dummy partition.
CREATE TABLE part_test (key STRING, value STRING) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- Tests the case where a table is changed from sequence file to a RC file,
-- resulting in partitions in both file formats. If no valid partitions are
-- selected, then it should still use RC file for reading the dummy partition.
CREATE TABLE part_test (key STRING, value STRING) PARTITIONED BY (ds STRING) STORED AS SEQUENCEFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@part_test
PREHOOK: query: ALTER TABLE part_test ADD PARTITION(ds='1')
PREHOOK: type: ALTERTABLE_ADDPARTS
POSTHOOK: query: ALTER TABLE part_test ADD PARTITION(ds='1')
POSTHOOK: type: ALTERTABLE_ADDPARTS
POSTHOOK: Output: default@part_test@ds=1
PREHOOK: query: ALTER TABLE part_test SET FILEFORMAT RCFILE
PREHOOK: type: null
POSTHOOK: query: ALTER TABLE part_test SET FILEFORMAT RCFILE
POSTHOOK: type: null
POSTHOOK: Input: default@part_test
POSTHOOK: Output: default@part_test
PREHOOK: query: ALTER TABLE part_test ADD PARTITION(ds='2')
PREHOOK: type: ALTERTABLE_ADDPARTS
POSTHOOK: query: ALTER TABLE part_test ADD PARTITION(ds='2')
POSTHOOK: type: ALTERTABLE_ADDPARTS
POSTHOOK: Output: default@part_test@ds=2
PREHOOK: query: SELECT count(1) FROM part_test WHERE ds='3'
PREHOOK: type: QUERY
PREHOOK: Output: file:/tmp/jssarma/hive_2010-07-21_11-21-20_502_7998672376160685808/10000
POSTHOOK: query: SELECT count(1) FROM part_test WHERE ds='3'
POSTHOOK: type: QUERY
POSTHOOK: Output: file:/tmp/jssarma/hive_2010-07-21_11-21-20_502_7998672376160685808/10000
0
