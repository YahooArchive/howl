PREHOOK: query: -- test for loading into tables with the correct file format
-- test for loading into partitions with the correct file format


CREATE TABLE T1(name STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: -- test for loading into tables with the correct file format
-- test for loading into partitions with the correct file format


CREATE TABLE T1(name STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@T1
PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.txt' INTO TABLE T1
PREHOOK: type: LOAD
POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.txt' INTO TABLE T1
POSTHOOK: type: LOAD
POSTHOOK: Output: default@t1
PREHOOK: query: SELECT COUNT(1) FROM T1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-38_208_6942362751444337631/-mr-10000
POSTHOOK: query: SELECT COUNT(1) FROM T1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-38_208_6942362751444337631/-mr-10000
500
PREHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE T2(name STRING) STORED AS SEQUENCEFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@T2
PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.seq' INTO TABLE T2
PREHOOK: type: LOAD
POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.seq' INTO TABLE T2
POSTHOOK: type: LOAD
POSTHOOK: Output: default@t2
PREHOOK: query: SELECT COUNT(1) FROM T2
PREHOOK: type: QUERY
PREHOOK: Input: default@t2
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-41_054_6564363936212747087/-mr-10000
POSTHOOK: query: SELECT COUNT(1) FROM T2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t2
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-41_054_6564363936212747087/-mr-10000
500
PREHOOK: query: CREATE TABLE T3(name STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE T3(name STRING) PARTITIONED BY(ds STRING) STORED AS TEXTFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@T3
PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.txt' INTO TABLE T3 PARTITION (ds='2008-04-09')
PREHOOK: type: LOAD
POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.txt' INTO TABLE T3 PARTITION (ds='2008-04-09')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@t3@ds=2008-04-09
PREHOOK: query: SELECT COUNT(1) FROM T3 where T3.ds='2008-04-09'
PREHOOK: type: QUERY
PREHOOK: Input: default@t3@ds=2008-04-09
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-43_724_6669484579821533203/-mr-10000
POSTHOOK: query: SELECT COUNT(1) FROM T3 where T3.ds='2008-04-09'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t3@ds=2008-04-09
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-43_724_6669484579821533203/-mr-10000
500
PREHOOK: query: CREATE TABLE T4(name STRING) PARTITIONED BY(ds STRING) STORED AS SEQUENCEFILE
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE TABLE T4(name STRING) PARTITIONED BY(ds STRING) STORED AS SEQUENCEFILE
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@T4
PREHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.seq' INTO TABLE T4 PARTITION (ds='2008-04-09')
PREHOOK: type: LOAD
POSTHOOK: query: LOAD DATA LOCAL INPATH '../data/files/kv1.seq' INTO TABLE T4 PARTITION (ds='2008-04-09')
POSTHOOK: type: LOAD
POSTHOOK: Output: default@t4@ds=2008-04-09
PREHOOK: query: SELECT COUNT(1) FROM T4 where T4.ds='2008-04-09'
PREHOOK: type: QUERY
PREHOOK: Input: default@t4@ds=2008-04-09
PREHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-46_518_8734843392472439359/-mr-10000
POSTHOOK: query: SELECT COUNT(1) FROM T4 where T4.ds='2008-04-09'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t4@ds=2008-04-09
POSTHOOK: Output: file:/tmp/thiruvel/hive_2010-09-14_08-21-46_518_8734843392472439359/-mr-10000
500
PREHOOK: query: DESCRIBE EXTENDED T1
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE EXTENDED T1
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
name                	string              	None                
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
Owner:              	thiruvel            	 
CreateTime:         	Tue Sep 14 08:21:38 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Retention:          	0                   	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/t1	 
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	transient_lastDdlTime	1284477698          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
PREHOOK: query: DESCRIBE EXTENDED T2
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE EXTENDED T2
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
name                	string              	None                
	 	 
# Detailed Table Information	 	 
Database:           	default             	 
Owner:              	thiruvel            	 
CreateTime:         	Tue Sep 14 08:21:40 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Retention:          	0                   	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/t2	 
Table Type:         	MANAGED_TABLE       	 
Table Parameters:	 	 
	transient_lastDdlTime	1284477701          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.SequenceFileInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
PREHOOK: query: DESCRIBE EXTENDED T3 PARTITION (ds='2008-04-09')
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE EXTENDED T3 PARTITION (ds='2008-04-09')
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
name                	string              	None                
	 	 
# Partition Information	 	 
col_name            	data_type           	comment             
	 	 
ds                  	string              	None                
	 	 
# Detailed Partition Information	 	 
Partition Value:    	[2008-04-09]        	 
Database:           	default             	 
Table:              	t3                  	 
CreateTime:         	Tue Sep 14 08:21:43 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/t3/ds=2008-04-09	 
Partition Parameters:	 	 
	transient_lastDdlTime	1284477703          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.TextInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
PREHOOK: query: DESCRIBE EXTENDED T4 PARTITION (ds='2008-04-09')
PREHOOK: type: DESCTABLE
POSTHOOK: query: DESCRIBE EXTENDED T4 PARTITION (ds='2008-04-09')
POSTHOOK: type: DESCTABLE
col_name            	data_type           	comment             
	 	 
name                	string              	None                
	 	 
# Partition Information	 	 
col_name            	data_type           	comment             
	 	 
ds                  	string              	None                
	 	 
# Detailed Partition Information	 	 
Partition Value:    	[2008-04-09]        	 
Database:           	default             	 
Table:              	t4                  	 
CreateTime:         	Tue Sep 14 08:21:46 PDT 2010	 
LastAccessTime:     	Wed Dec 31 16:00:00 PST 1969	 
Protect Mode:       	None                	 
Location:           	pfile:/home/thiruvel/projects/hive/hive/build/ql/test/data/warehouse/t4/ds=2008-04-09	 
Partition Parameters:	 	 
	transient_lastDdlTime	1284477706          
	 	 
# Storage Information	 	 
SerDe Library:      	org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe	 
InputFormat:        	org.apache.hadoop.mapred.SequenceFileInputFormat	 
OutputFormat:       	org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat	 
Compressed:         	No                  	 
Num Buckets:        	-1                  	 
Bucket Columns:     	[]                  	 
Sort Columns:       	[]                  	 
Storage Desc Params:	 	 
	serialization.format	1                   
	 	 
